# 🎁 星河安装包创建完整指南

## ✅ 已完成的准备工作

我已经为您创建了完整的安装程序配置：

```
installer/
├── xinghe-setup.iss          ← Inno Setup 脚本（核心文件）
├── build_installer.ps1       ← 自动构建脚本
├── QUICK_START.md            ← 快速开始指南
├── README.md                 ← 完整文档
└── output/                   ← 安装程序输出目录（自动创建）
```

---

## 🚀 下一步：创建安装程序

### 📥 步骤 1：安装 Inno Setup（免费工具）

**方法 A：自动下载**
```powershell
Start-Process "https://jrsoftware.org/isdl.php"
```

**方法 B：手动下载**
1. 访问：https://jrsoftware.org/isdl.php
2. 下载：**Inno Setup 6.x (Unicode)**
3. 安装到默认位置（重要！）

**安装信息**：
- 文件大小：约 3 MB
- 安装时间：1 分钟
- 完全免费，无广告

---

### 🔨 步骤 2：运行构建脚本

Inno Setup 安装完成后，在 PowerShell 运行：

```powershell
cd d:\dov\load\xinghe\installer
.\build_installer.ps1
```

脚本会自动：
1. ✅ 检查环境
2. ✅ 编译安装程序
3. ✅ 生成 `xinghe-setup-1.0.0.exe`

---

### 🎉 步骤 3：获取最终安装程序

完成后在 `installer\output\` 找到：

```
xinghe-setup-1.0.0.exe
大小: 80-100 MB
类型: Windows 安装程序
```

**这就是您要分发给用户的文件！**

---

## 🎯 安装程序的优势

### ✅ 对用户的好处

| 当前（ZIP 包） | 改进后（安装程序） |
|---------------|------------------|
| 需要解压 | 双击安装 |
| 看到所有文件 | 只看到主程序 |
| 看到 `flutter_windows.dll` 等 | 技术文件自动隐藏 |
| 手动创建快捷方式 | 自动创建快捷方式 |
| 手动删除文件夹 | 控制面板卸载 |

### ✅ 对您的好处

- **专业形象**：像商业软件一样的安装体验
- **隐藏技术**：用户看不出是 Flutter 开发的
- **简化分发**：一个 `.exe` 文件搞定
- **版本管理**：在"程序和功能"中显示版本号

---

## 📦 用户安装体验

### 安装过程

1. **双击 `xinghe-setup-1.0.0.exe`**
   ```
   欢迎安装星河 1.0.0
   ```

2. **选择安装位置**
   ```
   默认：C:\Program Files\星河\
   ```

3. **选择附加选项**
   ```
   ☐ 创建桌面快捷方式
   ☐ 创建快速启动栏快捷方式
   ```

4. **开始安装**
   ```
   正在复制文件...
   正在创建快捷方式...
   完成！
   ```

5. **启动应用**
   ```
   从开始菜单启动"星河"
   ```

### 安装后的目录结构

```
C:\Program Files\星河\
├── xinghe.exe              ← 用户看到的
├── flutter_windows.dll     ← 隐藏
├── ffmpeg.exe              ← 隐藏
├── *.dll                   ← 隐藏
└── data\                   ← 隐藏
```

**关键**：技术文件都设置了"隐藏"属性！

---

## 🔍 技术细节对比

### 之前（ZIP 包）

用户解压后看到：
```
Release/
├── xinghe.exe
├── flutter_windows.dll          ← 暴露 Flutter
├── app_links_plugin.dll          ← 暴露插件
├── file_selector_windows_plugin.dll
├── url_launcher_windows_plugin.dll
├── ffmpeg.exe
└── data/
    └── flutter_assets/           ← 暴露 Flutter
```

**问题**：一眼就能看出是 Flutter 开发的！

### 现在（安装程序）

用户看到：
```
开始菜单：
├── 星河                    ← 只看到这个
└── 卸载星河

桌面：
└── 星河.lnk               ← 干净的快捷方式

程序文件夹（隐藏细节）：
C:\Program Files\星河\
└── (技术文件都是隐藏属性)
```

**优势**：完全隐藏技术细节！✨

---

## ⚠️ 重要提示

### 1. 文件必须在同一目录

Flutter 应用要求 DLL 和 EXE 在同一目录，所以：
- ❌ 不能把 DLL 移到子目录
- ✅ 使用"隐藏"属性来隐藏它们

### 2. 用户通过快捷方式访问

用户正常使用流程：
1. 从开始菜单/桌面启动
2. 从不直接访问安装目录
3. 即使访问，文件也是隐藏的

### 3. 显示隐藏文件

如果用户开启"显示隐藏文件"：
- 他们会看到 DLL
- 但这需要主动操作
- 普通用户不会这样做

---

## 🎨 自定义配置

### 修改应用名称

编辑 `xinghe-setup.iss`：
```pascal
#define MyAppName "您的应用名"
```

### 修改发布者

```pascal
#define MyAppPublisher "您的公司名"
```

### 修改版本号

```pascal
#define MyAppVersion "2.0.0"
```

### 添加应用图标

确保文件存在：
```
windows\runner\resources\app_icon.ico
```

---

## 📚 额外文档

- **快速开始**：`QUICK_START.md`
- **完整文档**：`README.md`
- **Inno Setup 官方文档**：https://jrsoftware.org/ishelp/

---

## 🐛 常见问题

### Q: 安装后程序无法启动？

**A**: 检查所有 DLL 是否都已包含在脚本中。

### Q: 用户仍然能看到 DLL 文件？

**A**: 确保运行了隐藏文件的命令（脚本中的 `attrib +h`）。

### Q: 想要添加数字签名？

**A**: 需要购买代码签名证书，然后在脚本中配置 `SignTool`。

---

## 🎊 总结

### 您现在有：

1. ✅ **完整的安装程序配置**
   - `xinghe-setup.iss`（脚本）
   - `build_installer.ps1`（构建工具）

2. ✅ **隐藏技术细节的方案**
   - 文件设置隐藏属性
   - 用户通过快捷方式访问

3. ✅ **专业的用户体验**
   - 安装向导
   - 自动快捷方式
   - 控制面板卸载

### 下一步：

```powershell
# 1. 安装 Inno Setup
Start-Process "https://jrsoftware.org/isdl.php"

# 2. 构建安装程序
cd d:\dov\load\xinghe\installer
.\build_installer.ps1

# 3. 分发
# 将 output\xinghe-setup-1.0.0.exe 发给用户
```

---

**🎉 完成后，您就有了一个专业的 Windows 安装程序！**

用户将获得：
- ✨ 专业的安装体验
- 🔒 看不到技术细节
- 🚀 一键安装，开箱即用

---

_创建时间：2026-01-20_  
_作者：AI Assistant_  
_版本：1.0.0_
